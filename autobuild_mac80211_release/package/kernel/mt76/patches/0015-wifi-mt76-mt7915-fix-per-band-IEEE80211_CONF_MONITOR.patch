From 836354f8efe05bf4e7b1535202ac6cce5b7b474e Mon Sep 17 00:00:00 2001
From: Shayne Chen <shayne.chen@mediatek.com>
Date: Wed, 30 Aug 2023 18:51:08 +0800
Subject: [PATCH 15/16] wifi: mt76: mt7915: fix per-band IEEE80211_CONF_MONITOR
 flag comparison

Use the correct ieee80211_conf on each band for IEEE80211_CONF_MONITOR
comparison.

Signed-off-by: Shayne Chen <shayne.chen@mediatek.com>
---
 mt7915/mcu.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/mt7915/mcu.c b/mt7915/mcu.c
index 07f555c6..833971b9 100644
--- a/mt7915/mcu.c
+++ b/mt7915/mcu.c
@@ -2743,7 +2743,7 @@ int mt7915_mcu_set_chan_info(struct mt7915_phy *phy, int cmd)
 	if (mt76_connac_spe_idx(phy->mt76->antenna_mask))
 		req.tx_path_num = fls(phy->mt76->antenna_mask);
 
-	if (dev->mt76.hw->conf.flags & IEEE80211_CONF_MONITOR)
+	if (phy->mt76->hw->conf.flags & IEEE80211_CONF_MONITOR)
 		req.switch_reason = CH_SWITCH_NORMAL;
 	else if (phy->mt76->hw->conf.flags & IEEE80211_CONF_OFFCHANNEL ||
 		 phy->mt76->hw->conf.flags & IEEE80211_CONF_IDLE)
-- 
2.39.2

